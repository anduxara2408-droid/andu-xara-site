<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andu Xara - Codes Promo</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="auth.js"></script>
    <script src="firebase-config.js"></script>
    
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .auth-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            margin-bottom: 20px;
        }
        .btn-auth {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        .networks-section {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            margin-bottom: 20px;
        }
        .instructions {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé´ Codes Promo Andu Xara</h1>
    </div>

    <div class="auth-section">
        <h2>Acc√©dez √† vos avantages</h2>
        <button class="btn-auth" onclick="window.location.href='index.html'">üîê Se Connecter</button>
        <button class="btn-auth" onclick="window.location.href='index.html?register=true'">üìù Cr√©er un Compte</button>
    </div>

    <div class="networks-section">
        <h3>üì± Nos R√©seaux</h3>
        <p>Suivez-nous pour recevoir des codes promo exclusifs</p>
    </div>

    <div class="instructions">
        <p><strong>Connectez-vous ou cr√©ez un compte pour utiliser vos codes promo et passer commande</strong></p>
    </div>

    <script>
        // V√©rification si l'utilisateur est d√©j√† connect√©
        function checkAuth() {
            getCurrentUser().then(function(user) {
                if (user) {
                    // Si connect√©, on montre l'interface parrainage
                    showParrainageInterface();
                }
            }).catch(function(error) {
                console.log("Utilisateur non connect√©");
            });
        }

        // Interface parrainage pour utilisateurs connect√©s
        function showParrainageInterface() {
            document.body.innerHTML = `
                <div class="header">
                    <h1>üéÅ Parrainage Andu Xara</h1>
                </div>

                <div class="auth-section">
                    <button class="btn-auth" onclick="genererLienParrainage()">üìã Copier mon lien de parrainage</button>
                </div>

                <div class="networks-section">
                    <h3>üéØ Comment √ßa marche ?</h3>
                    <p>1Ô∏è‚É£ Partagez votre lien de parrainage</p>
                    <p>2Ô∏è‚É£ Votre ami s'inscrit avec votre lien</p>
                    <p>3Ô∏è‚É£ Vous gagnez 15% de ses achats</p>
                    <p>4Ô∏è‚É£ Votre ami gagne 10% de r√©duction</p>
                </div>

                <div class="instructions">
                    <p><strong>Votre lien de parrainage personnel vous attend !</strong></p>
                </div>
            `;
        }

        // Fonction pour g√©n√©rer le lien de parrainage
        function genererLienParrainage() {
            getCurrentUser().then(function(user) {
                if (user) {
                    // G√©n√©rer un code unique
                    const codeParrainage = "ANDU-" + Math.random().toString(36).substr(2, 8).toUpperCase();
                    const lienParrainage = window.location.origin + "/andu-xara-site/index.html?ref=" + codeParrainage;
                    
                    // Copier dans le presse-papier
                    navigator.clipboard.writeText(lienParrainage).then(function() {
                        alert("‚úÖ Lien de parrainage copi√© !\\n\\n" + lienParrainage);
                    });
                } else {
                    alert("‚ùå Veuillez vous connecter");
                }
            });
        }

        // V√©rification au chargement
        document.addEventListener('DOMContentLoaded', checkAuth);
    </script>
</body>
</html>
